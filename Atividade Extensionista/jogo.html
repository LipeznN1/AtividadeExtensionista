<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inclus√£o Digital para Idosos</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #0A84FF;  
            --success-color: #30D158; 
            --danger-color: #FF453A;   
            --neutral-color: #5A5A5D;  
            --bg-color: #1C1C1E;        
            --container-bg: #2C2C2E;    
            --text-color: #F2F2F7;      
            --text-secondary: #8E8E93; 
            --border-color: #3A3A3C;    
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color); 
            color: var(--text-color); 
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            text-align: center;
            /* Previne zoom duplo no celular */
            touch-action: manipulation; 
        }

        /* Container principal RESPONSIVO */
        #menu-principal, #area-jogo {
            background-color: var(--container-bg); 
            padding: 0;
            padding-bottom: 30px;
            border-radius: 12px;
            border: 1px solid var(--border-color); 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px; 
            transition: all 0.3s ease; 
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        #area-jogo { padding: 20px; }

        #menu-imagem {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 1px solid var(--border-color);
        }

        h1, h2, h3 { color: var(--text-color); margin: 15px 0; }
        p { color: var(--text-secondary); }

        button {
            display: block;
            width: 90%;
            margin: 15px auto;
            padding: 16px; 
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 8px; 
            background-color: var(--primary-color);
            color: white;
            transition: filter 0.2s ease, transform 0.1s ease; 
        }
        button:hover { filter: brightness(85%); }
        button:active { transform: scale(0.98); }
        #btn-voltar { background-color: var(--neutral-color); }

        .hidden { display: none !important; }

        /* --- JOGO DO MOUSE --- */
        #alvo-container {
            width: 100%;
            height: 350px;
            position: relative;
            background-color: #222;
            border-radius: 8px;
            border: 1px dashed #444;
            margin-top: 10px;
            overflow: hidden;
            /* Importante para mobile: */
            touch-action: none; 
        }

        #alvo {
            width: 80px;
            height: 80px;
            background-color: var(--danger-color) !important; 
            border-radius: 50%;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: white;
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent; /* Remove flash azul */
            box-shadow: 0 0 15px rgba(255, 69, 58, 0.6); /* Glow para facilitar ver */
        }

        /* --- JOGO DO TECLADO --- */
        #letra-display {
            border: 2px solid var(--border-color);
            color: var(--primary-color) !important;
            background-color: var(--bg-color); 
            font-weight: 700 !important;
            font-size: 4em !important; 
            padding: 20px !important;
            margin: 20px auto;
            min-width: 100px;
            border-radius: 10px;
        }
        #input-mobile {
            opacity: 0; /* Invisivel mas clic√°vel */
            position: absolute;
            top: -1000px;
        }

        /* --- JOGO DE NAVEGA√á√ÉO --- */
        #fake-site {
            border: 2px solid var(--border-color);
            padding: 15px;
            margin-top: 20px;
            text-align: left; 
            background-color: var(--bg-color); 
            border-radius: 8px;
        }
        .fake-link {
            font-size: 1.1em;
            color: var(--primary-color);
            text-decoration: none; 
            cursor: pointer;
            display: block; 
            margin-top: 10px;
            padding: 12px;
            border-radius: 5px;
            background-color: rgba(255,255,255,0.05);
            font-weight: 500;
        }
        #fake-site button { background-color: var(--primary-color); width: 100%; margin: 10px 0; }
        #fake-site button[style*="6c757d"] { background-color: var(--neutral-color); }
    </style>
</head>
<body>

    <div id="menu-principal">
        <img src="imagem-menu.jpg" alt="Idosos aprendendo a usar o computador" id="menu-imagem" onerror="this.style.display='none'">
        <h1>Aprendendo a usar o computador</h1>
        <p>Escolha por onde come√ßar:</p>
        <button id="btn-mouse">1. Praticar com o Mouse</button>
        <button id="btn-teclado">2. Praticar com o Teclado</button>
        <button id="btn-navegacao">3. Praticar Navega√ß√£o</button>
    </div>

    <div id="area-jogo" class="hidden">
        <div id="game-content"></div>
        <button id="btn-voltar">Voltar ao Menu</button>
    </div>

    <input type="text" id="input-mobile">

    <script>
        const menuPrincipal = document.getElementById('menu-principal');
        const areaJogo = document.getElementById('area-jogo');
        const gameContent = document.getElementById('game-content');
        const inputMobile = document.getElementById('input-mobile');

        const btnMouse = document.getElementById('btn-mouse');
        const btnTeclado = document.getElementById('btn-teclado');
        const btnNavegacao = document.getElementById('btn-navegacao');
        const btnVoltar = document.getElementById('btn-voltar');

        // Vari√°veis de Controle
        let mouseGameTimerId = null; 
        let mouseGameScore = 0;      
        let mouseGameErrors = 0;     
        let isMouseGameActive = false; 
        let ignoreErrorsTime = false; // NOVA TRAVA DE SEGURAN√áA MOUSE
        
        let teclasDoJogoAtual = []; 
        let indiceTeclaAtual = 0;
        let letraAlvoDisplay; 
        let feedbackDisplay;  
        let keyboardGameLevel = 1; 
        let isProcessingKey = false; 
        
        // N√≠veis
        const LEVEL_1_KEYS = ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', '√á']; 
        const LEVEL_2_KEYS = ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P']; 
        const LEVEL_3_KEYS = ['Z', 'X', 'C', 'V', 'B', 'N', 'M']; 
        const LEVEL_4_KEYS = [...LEVEL_1_KEYS, ...LEVEL_2_KEYS]; 
        const LEVEL_5_KEYS = [...LEVEL_1_KEYS, ...LEVEL_2_KEYS, ...LEVEL_3_KEYS]; 

        btnMouse.addEventListener('click', iniciarJogoMouse);
        btnTeclado.addEventListener('click', iniciarJogoTeclado);
        btnNavegacao.addEventListener('click', iniciarJogoNavegacao);
        btnVoltar.addEventListener('click', voltarAoMenu);
        
        // Listener Global de Erro
        gameContent.addEventListener('click', registrarErroMouse);

        function mostrarAreaJogo() {
            menuPrincipal.classList.add('hidden'); 
            areaJogo.classList.remove('hidden');  
            window.scrollTo(0,0);
        }

        function voltarAoMenu() {
            areaJogo.classList.add('hidden');        
            menuPrincipal.classList.remove('hidden'); 
            gameContent.innerHTML = ''; 
            clearInterval(mouseGameTimerId); 
            window.onkeydown = null;
            inputMobile.blur(); 
            isMouseGameActive = false; 
        }

        // ==========================================================
        // 1. JOGO DO MOUSE
        // ==========================================================
        function iniciarJogoMouse() {
            mostrarAreaJogo();
            gameContent.innerHTML = ''; 
            
            mouseGameScore = 0;
            mouseGameErrors = 0; 
            isMouseGameActive = true; 
            ignoreErrorsTime = false; // Reset da trava
            let timeLeft = 15;

            const titulo = document.createElement('h2');
            titulo.id = 'mouse-game-title'; 
            titulo.textContent = 'Toque no Alvo!';
            gameContent.appendChild(titulo); 

            const statsContainer = document.createElement('div');
            statsContainer.style.display = 'flex';
            statsContainer.style.justifyContent = 'space-around';
            statsContainer.style.padding = '10px 0';
            statsContainer.innerHTML = `
                <p id="score-display" style="font-size:1.2em; color:var(--success-color)">Pontos: 0</p>
                <p id="timer-display" style="font-size:1.2em; color:var(--danger-color)">Tempo: 15</p>
                <p id="error-display" style="font-size:1.2em; color:#FF8A85">Erros: 0</p>
            `;
            gameContent.appendChild(statsContainer);

            const alvoContainer = document.createElement('div');
            alvoContainer.id = 'alvo-container';
            gameContent.appendChild(alvoContainer); 
            
            const alvo = document.createElement('div');
            alvo.id = 'alvo';
            alvo.textContent = 'Aqui!';
            alvoContainer.appendChild(alvo); 
            
            alvo.addEventListener('touchstart', (e) => { 
                e.preventDefault();
                e.stopPropagation();
                moverAlvo(); 
            }, { passive: false });
            
            alvo.addEventListener('mousedown', (e) => {
                e.stopPropagation();
                moverAlvo();
            }); 

            mouseGameTimerId = setInterval(() => {
                timeLeft--; 
                const tDisplay = document.getElementById('timer-display');
                if(tDisplay) tDisplay.textContent = 'Tempo: ' + timeLeft;
                if (timeLeft <= 0) encerrarJogoMouse(); 
            }, 1000); 
            
            // Centraliza
            alvo.style.top = "50%";
            alvo.style.left = "50%";
            alvo.style.transform = "translate(-50%, -50%)";
        }

        function moverAlvo() {
            if (!isMouseGameActive) return; 
            
            // Ignora qualquer erro pelos pr√≥ximos 350ms (tempo do ghost click sumir)
            ignoreErrorsTime = true;
            setTimeout(() => { ignoreErrorsTime = false; }, 350);

            mouseGameScore++;
            const scoreDisplay = document.getElementById('score-display');
            if (scoreDisplay) scoreDisplay.textContent = 'Pontos: ' + mouseGameScore;

            const alvo = document.getElementById('alvo');
            const container = document.getElementById('alvo-container');
            
            if (!alvo || !container) return; 

            // C√°lculo Responsivo
            let maxX = container.clientWidth - 80; 
            let maxY = container.clientHeight - 80;

            if (maxX < 0) maxX = 0; 
            if (maxY < 0) maxY = 0;

            const randomX = Math.floor(Math.random() * maxX);
            const randomY = Math.floor(Math.random() * maxY);
            
            alvo.style.transform = "none";
            alvo.style.left = randomX + 'px';
            alvo.style.top = randomY + 'px';
        }

        function registrarErroMouse(e) {
            if (!isMouseGameActive) return;
            
            // SE A TRAVA ESTIVER ATIVA, N√ÉO CONTA ERRO NENHUM
            if (ignoreErrorsTime) return;

            // Se clicou no alvo, sai
            if (e.target.id === 'alvo') return;

            // S√≥ conta erro se for no container
            if (e.target.id === 'alvo-container') {
                mouseGameErrors++;
                const errorDisplay = document.getElementById('error-display');
                if (errorDisplay) errorDisplay.textContent = 'Erros: ' + mouseGameErrors;
            }
        }

        function encerrarJogoMouse() {
            clearInterval(mouseGameTimerId);
            isMouseGameActive = false; 
            const alvo = document.getElementById('alvo');
            if (alvo) alvo.style.display = 'none';
            const titulo = document.getElementById('mouse-game-title');
            if (titulo) {
                titulo.innerHTML = `Fim! <br> Pontos: ${mouseGameScore} | Erros: ${mouseGameErrors}`;
                titulo.style.color = "var(--primary-color)"; 
            }
        }

        // ==========================================================
        // 2. JOGO DO TECLADO
        // ==========================================================
        function embaralharArray(array) {
            let arrayCopiado = [...array]; 
            for (let i = arrayCopiado.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arrayCopiado[i], arrayCopiado[j]] = [arrayCopiado[j], arrayCopiado[i]];
            }
            return arrayCopiado;
        }
        
        function iniciarJogoTeclado() {
            mostrarAreaJogo();
            keyboardGameLevel = 1; 
            startKeyboardLevel(keyboardGameLevel); 
        }

        function startKeyboardLevel(level) {
            gameContent.innerHTML = ''; 
            indiceTeclaAtual = 0; 
            isProcessingKey = false;
            
            let keysForThisLevel;
            switch (level) {
                case 1: keysForThisLevel = LEVEL_1_KEYS; break;
                case 2: keysForThisLevel = LEVEL_2_KEYS; break;
                case 3: keysForThisLevel = LEVEL_3_KEYS; break;
                case 4: keysForThisLevel = LEVEL_4_KEYS; break;
                case 5: keysForThisLevel = LEVEL_5_KEYS; break;
                default: renderKeyboardVitoria(); return;
            }
            teclasDoJogoAtual = embaralharArray(keysForThisLevel);

            gameContent.innerHTML = `<h2>Jogo do Teclado - N√≠vel ${level}</h2>
                <p>Toque na letra abaixo para abrir o teclado:</p>`;

            letraAlvoDisplay = document.createElement('div');
            letraAlvoDisplay.id = 'letra-display';
            gameContent.appendChild(letraAlvoDisplay);
            
            letraAlvoDisplay.onclick = () => {
                inputMobile.focus();
                inputMobile.click();
            };

            feedbackDisplay = document.createElement('p');
            feedbackDisplay.id = 'feedback-teclado';
            feedbackDisplay.textContent = 'Clique no quadrado acima ‚òùÔ∏è';
            gameContent.appendChild(feedbackDisplay);

            mostrarProximaLetra(); 
            
            window.onkeydown = verificarTecla;
            inputMobile.oninput = (e) => {
                if(e.data) {
                    // For√ßa mai√∫scula e pega o √∫ltimo caractere digitado
                    const key = e.data.slice(-1).toUpperCase();
                    verificarTecla({ key: key });
                    inputMobile.value = ''; 
                }
            };
            inputMobile.focus();
        }

        function mostrarProximaLetra() {
            if (indiceTeclaAtual >= teclasDoJogoAtual.length) {
                window.onkeydown = null; 
                inputMobile.blur();
                if (keyboardGameLevel < 5) renderKeyboardLevelComplete();
                else renderKeyboardVitoria();
            } else {
                letraAlvoDisplay.textContent = teclasDoJogoAtual[indiceTeclaAtual]; 
                feedbackDisplay.textContent = 'Digite a letra que v√™...';
                feedbackDisplay.style.color = 'var(--text-secondary)';
                isProcessingKey = false; 
            }
        }

        function verificarTecla(event) {
            if (isProcessingKey) return; 
            if (!letraAlvoDisplay || indiceTeclaAtual >= teclasDoJogoAtual.length) return;

            let letraAlvo = teclasDoJogoAtual[indiceTeclaAtual]; 
            let letraPressionada = event.key.toUpperCase();

            // Prote√ß√£o contra teclas especiais
            if (letraPressionada.length > 1) return;

            if (letraPressionada === letraAlvo) {
                isProcessingKey = true;
                indiceTeclaAtual++;
                feedbackDisplay.textContent = 'Correto!';
                feedbackDisplay.style.color = 'var(--success-color)';
                setTimeout(mostrarProximaLetra, 400); // 400ms delay
            } else {
                feedbackDisplay.textContent = `Era '${letraAlvo}', voc√™ digitou '${letraPressionada}'`;
                feedbackDisplay.style.color = 'var(--danger-color)';
            }
        }

        function renderKeyboardLevelComplete() {
            gameContent.innerHTML = `<h2 style="color:var(--success-color)">N√≠vel ${keyboardGameLevel} completo!</h2>`;
            const btnProximoNivel = document.createElement('button');
            keyboardGameLevel++; 
            btnProximoNivel.textContent = `Ir para o N√≠vel ${keyboardGameLevel}`;
            btnProximoNivel.onclick = () => startKeyboardLevel(keyboardGameLevel); 
            gameContent.appendChild(btnProximoNivel);
        }

        function renderKeyboardVitoria() {
            gameContent.innerHTML = `<h2 style="color:var(--success-color)">üèÜ Parab√©ns! Voc√™ Venceu!</h2>`;
            const btnJogarDeNovo = document.createElement('button');
            btnJogarDeNovo.textContent = 'Jogar de Novo';
            btnJogarDeNovo.onclick = iniciarJogoTeclado; 
            gameContent.appendChild(btnJogarDeNovo);
        }

        // ==========================================================
        // 3. JOGO DE NAVEGA√á√ÉO
        // ==========================================================
        let navInstrucao, navFeedback, fakeSiteContainer;
        let currentGameQuest = {};
        let currentQuestStep = 0;

        const NAV_QUESTS = [
            { id: 'tecnologia', steps: [
                { pageTitle: 'Portal Inicial', instruction: "Toque em 'Not√≠cias'.", correctLink: 'Not√≠cias', allLinks: ['Not√≠cias', 'Esportes', 'Receitas', 'Sa√∫de'] },
                { pageTitle: 'Not√≠cias', instruction: "Toque em 'Tecnologia'.", correctLink: 'Tecnologia', allLinks: ['Pol√≠tica', 'Tecnologia', 'Mundo', 'Tempo'] },
                { pageTitle: 'Tecnologia', instruction: "Toque em 'Lan√ßamentos'.", correctLink: 'Lan√ßamentos', allLinks: ['Software', 'Hardware', 'IA', 'Lan√ßamentos'] },
                { pageTitle: 'Lan√ßamentos', instruction: "Toque em 'Novo Celular'.", correctLink: 'Novo Celular', allLinks: ['Mouses', 'Novo Celular', 'Novo Notebook'] }
            ]},
            { id: 'culinaria', steps: [
                { pageTitle: 'Portal Inicial', instruction: "Toque em 'Receitas'.", correctLink: 'Receitas', allLinks: ['Not√≠cias', 'Esportes', 'Receitas', 'Sa√∫de'] },
                { pageTitle: 'Receitas', instruction: "Toque em 'Bolos'.", correctLink: 'Bolos', allLinks: ['Sorvetes', 'Massas', 'Bolos', 'Salgados'] },
                { pageTitle: 'Bolos', instruction: "Toque em 'Bolo de Chocolate'.", correctLink: 'Bolo de Chocolate', allLinks: ['Bolo de Laranja', 'Torta de Ma√ß√£', 'Bolo de Chocolate', 'Pudim'] },
                { pageTitle: 'Bolo de Chocolate', instruction: "Toque em 'Imprimir'.", correctLink: 'Imprimir', allLinks: ['Ver V√≠deo', 'Imprimir', 'Coment√°rios'] }
            ]}
        ];

        function iniciarJogoNavegacao() {
            mostrarAreaJogo();
            gameContent.innerHTML = ''; 
            currentGameQuest = NAV_QUESTS[Math.floor(Math.random() * NAV_QUESTS.length)];
            currentQuestStep = 0; 
            
            gameContent.innerHTML = `<h2>Jogo de Navega√ß√£o</h2><p id="nav-instrucao" style="padding:0 10px"></p>`;
            navInstrucao = document.getElementById('nav-instrucao');
            fakeSiteContainer = document.createElement('div');
            fakeSiteContainer.id = 'fake-site';
            gameContent.appendChild(fakeSiteContainer);
            navFeedback = document.createElement('p');
            navFeedback.id = 'feedback-nav';
            gameContent.appendChild(navFeedback);
            renderNavStep();
        }

        function renderNavStep() {
            if (currentQuestStep >= currentGameQuest.steps.length) { renderNavVitoria(); return; }
            const step = currentGameQuest.steps[currentQuestStep];
            navInstrucao.textContent = step.instruction;
            navFeedback.textContent = ''; 
            fakeSiteContainer.innerHTML = `<h3>${step.pageTitle}</h3>`;
            const linksEmbaralhados = embaralharArray(step.allLinks);
            linksEmbaralhados.forEach(textoDoLink => {
                const link = document.createElement('span');
                link.textContent = textoDoLink;
                link.className = 'fake-link';
                link.onclick = (textoDoLink === step.correctLink) ? cliqueCorretoNav : cliqueErradoNav;
                fakeSiteContainer.appendChild(link);
            });
        }

        function cliqueCorretoNav() {
            navFeedback.textContent = 'Carregando...';
            navFeedback.style.color = 'var(--success-color)';
            currentQuestStep++; 
            const links = document.querySelectorAll('.fake-link');
            links.forEach(link => link.onclick = null);
            setTimeout(renderNavStep, 800); 
        }

        function cliqueErradoNav() {
            const step = currentGameQuest.steps[currentQuestStep];
            navFeedback.textContent = `Tente clicar em '${step.correctLink}'.`;
            navFeedback.style.color = 'var(--danger-color)';
        }

        function renderNavVitoria() {
            navInstrucao.textContent = "Parab√©ns! Miss√£o Conclu√≠da! üëè";
            navFeedback.textContent = '';
            fakeSiteContainer.innerHTML = '<h2>Sucesso!</h2>';
            const btnJogarDeNovo = document.createElement('button');
            btnJogarDeNovo.textContent = 'Jogar Outra Miss√£o';
            btnJogarDeNovo.onclick = iniciarJogoNavegacao; 
            fakeSiteContainer.appendChild(btnJogarDeNovo);
        }
    </script>
</body>
</html>
